<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Insert title here</title>
<link href="http://libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
</head>


<body>
	<div class="panel panel-primary panel-lg">
	  
	    <div class="panel-heading" style="text-align:center;z-index:66;position:fixed;width:100%">
	        <h1 class="panel-title"><strong>爱培科管理制度</strong></h1>
	    </div>
	    <div style="z-index:66;position:fixed;width:100%;top:40px;">
	    	<form class="bs-example bs-example-form" >
	        <div class="input-group"> 
	       	 <div class="input-group-addon" style="cursor:pointer"><span class="glyphicon glyphicon-search"></span></div>
	            <input type="text" class="form-control" placeholder="搜索...." id="searchFileName">
	            <div class="input-group-addon" style="cursor:pointer" id="search">搜索</div>
	       </div>
		</form>
	 </div>
	    
	  <div style="height:65px;width:100%;background:gray">
	  </div>
	    <div class="panel-body" style="padding:0;  margin-top:5px">
			<ul class="list-group" >
			</ul>
   		 </div>  
	    </div>
	    <div class="panel-footer" style="position:fixed;bottom:0px;width:100%">
			<button class="btn btn-primary" id="top"><span style="color:#fff" class="glyphicon glyphicon-chevron-left"></span></button>
			<!-- <button class="btn btn-primary"><span style="color:#fff" class="glyphicon glyphicon-chevron-right"></span></button> -->
		</div>
	</div>
</body>
<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript" src="http://apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script>

<script>

var file = '<span class="glyphicon glyphicon-file"></span>';
var catalog = '<span class="glyphicon glyphicon-folder-open"></span>';
var curentPath = "f://"
var height = document.body.scrollWidth - 200;
$(".panel-body").css("height",height);

console.log(height);
function listFile(Currentpath, flag) {
	$.ajax({
		url:"file/getFileList",
		type:"post",
		dataType:"json",
		data:{"path":Currentpath},
		success:function(data){
			$(".list-group-item").remove();
			
			if(flag == "notParent"){
			/* 	$("#viewerPlaceHolder").css("display","block"); */
				return;
			}else{
				/* $("#viewerPlaceHolder").css("display","none"); */
			}
			
			console.log(data);
			var child = data.data.fileChild;
			var paramList = [];
			for(var i in child) {
				var icon;
				var f;
				if(child[i].isParent) {
					icon = catalog;
					f = "isParent";
				} else {
					icon = file;
					f = "notParent";
				}
				paramList.push('<li class="list-group-item" style="cursor:pointer" data-file="'+f+'" data-path="'+child[i].filepath+'">'+icon+'&nbsp;&nbsp;'+child[i].filename+'</li>')
			}
			$(".list-group").append(paramList);
		}
	})
}

$(function(){
	//listFile(curentPath);
	$("body").on("click",".list-group-item",function(){
		var path = $(this).attr("data-path");
		var flag = $(this).attr("data-file")
		curentPath = path;
		
		//listFile(path,flag);
	})
	
	$("#top").click(function(){
		/* $("#viewerPlaceHolder").css("display","none"); */
		$.ajax({
			url:"file/topDirector",
			data:{"path":curentPath},
			dataType:"json",
			type:"post",
			success:function(data){
				$(".list-group-item").remove();
				var child = data.data.fileChild;
				var paramList = [];
				for(var i in child) {
					var icon;
					if(child[i].isParent) {
						icon = catalog;
					} else {
						icon = file;
					}
					paramList.push('<li class="list-group-item" style="cursor:pointer" data-path="'+child[i].filepath+'">'+icon+'&nbsp;&nbsp;'+child[i].filename+'</li>')
				}
				$(".list-group").append(paramList);
			}
		})
	})
	
	$("#search").click(function(){

		var fileName = $("#searchFileName").val();
		$.ajax({
			url:"file/searchFile",
			type:"post",
			dataType:'json',
			data:{"fileName":fileName},
			beforeSend: function(){
				$("#search").attr("disabled","disabled")
			 },
			success:function(data){
				$(".list-group-item").remove();
				var child = data.data;
				var paramList = [];
				console.log(data)
				for(var i in child) {
					var icon;
					if(child[i].isParent) {
						icon = catalog;
					} else {
						icon = file;
					}
					paramList.push('<li class="list-group-item" style="cursor:pointer" data-path="'+child[i].filepath+'">'+icon+'&nbsp;&nbsp;'+child[i].filename+'</li>');
				}
				$(".list-group").append(paramList);
			},
			complete: function(){
				$("#search").removeAttr("disabled")
			}
		})
		
	})
})	
	
	
</script>


</html>
